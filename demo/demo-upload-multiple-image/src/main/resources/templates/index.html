<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <title>Home</title>
  <link rel="stylesheet" href="assets/css/bootstrap.css">
  <link rel="stylesheet" href="assets/css/sweetalert2.min.css">
  <link rel="stylesheet" href="assets/css/magnific-popup.css">
  <link rel="stylesheet" href="assets/css/preview-image.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body style="padding: 30px;">
  <span>Name : <input type="text" id="name"></span><br>
  <input type="file" id="imageFile" accept="image/jpeg, image/png" required multiple /><br>
  <input type="button" id="upload" th:value="Upload"/>
  <br>  <br>  <br>

  <span>Id : <input type="text" id="productId"></span><br>
  <button class="btn-outline-primary" id="show">Show</button>


  <script src="assets/js/jquery-3.6.0.js"></script>
  <script src="assets/js/jquery.validate-1.19.3.min.js"></script>
  <script src="assets/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/sweetalert2.min.js"></script>
  <script src="assets/js/magnific-popup-1.1.0.js"></script>
  <script src="assets/js/app.js"></script>

<script>

    $('#upload').on('click', function (){
      let formData  = new FormData();

      let fileInput = $('#imageFile')[0].files;

      if (fileInput.length !== 3)
        return alert("Should be have 3 images")

      formData.append("name", $('#name').val());
      formData.append("files", fileInput[0]);
      formData.append("files", fileInput[1]);
      formData.append("files", fileInput[2]);

      $.ajax({
        type: "POST",
        contentType: false,
        cache: false,
        processData: false,
        url: "http://localhost:8086/api/products",
        data: formData
      }).done(() => {
        console.log("Create successful")
      })
    })

    $('#show').on('click', function (){
      let productId = $('#productId').val();

      $.ajax({
        type: "GET",
        contentType: false,
        cache: false,
        processData: false,
        url: "http://localhost:8086/api/products/",
      })
      .done((data) => {
        console.log(data)
      })
      .fail((ex) => {
        console.log(ex)
      })
    })


</script>
</body>
</html>
